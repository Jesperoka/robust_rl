#ifndef __CAR_CONSTANTS_H__ 
#define __CAR_CONSTANTS_H__

#include <avr/pgmspace.h>

#define ANGLE_DISCRETIZATION 256 
#define ROTATIONAL_VELOCITY_DISCRETIZATION 16
#define MAGNITUDE_DISCRETIZATION 16

constexpr float VALID_SINES[ANGLE_DISCRETIZATION] PROGMEM = {
    0.0000000, 0.0245412, 0.0490677, 0.0735646, 0.0980171, 0.1224107, 0.1467305, 0.1709619,
    0.1950903, 0.2191012, 0.2429802, 0.2667128, 0.2902847, 0.3136817, 0.3368899, 0.3598950,
    0.3826834, 0.4052413, 0.4275551, 0.4496113, 0.4713967, 0.4928982, 0.5141027, 0.5349976,
    0.5555702, 0.5758082, 0.5956993, 0.6152316, 0.6343933, 0.6531728, 0.6715590, 0.6895405,
    0.7071068, 0.7242471, 0.7409511, 0.7572088, 0.7730105, 0.7883464, 0.8032075, 0.8175848,
    0.8314696, 0.8448536, 0.8577286, 0.8700870, 0.8819213, 0.8932243, 0.9039893, 0.9142098,
    0.9238795, 0.9329928, 0.9415441, 0.9495282, 0.9569403, 0.9637761, 0.9700313, 0.9757021,
    0.9807853, 0.9852776, 0.9891765, 0.9924795, 0.9951847, 0.9972905, 0.9987955, 0.9996988,
    1.0000000, 0.9996988, 0.9987955, 0.9972905, 0.9951847, 0.9924795, 0.9891765, 0.9852776,
    0.9807853, 0.9757021, 0.9700313, 0.9637761, 0.9569403, 0.9495282, 0.9415441, 0.9329928,
    0.9238795, 0.9142098, 0.9039893, 0.8932243, 0.8819213, 0.8700870, 0.8577286, 0.8448536,
    0.8314696, 0.8175848, 0.8032075, 0.7883464, 0.7730105, 0.7572088, 0.7409511, 0.7242471,
    0.7071068, 0.6895405, 0.6715590, 0.6531728, 0.6343933, 0.6152316, 0.5956993, 0.5758082,
    0.5555702, 0.5349976, 0.5141027, 0.4928982, 0.4713967, 0.4496113, 0.4275551, 0.4052413,
    0.3826834, 0.3598950, 0.3368899, 0.3136817, 0.2902847, 0.2667128, 0.2429802, 0.2191012,
    0.1950903, 0.1709619, 0.1467305, 0.1224107, 0.0980171, 0.0735646, 0.0490677, 0.0245412,
    0.0000000, -0.0245412, -0.0490677, -0.0735646, -0.0980171, -0.1224107, -0.1467305, -0.1709619,
    -0.1950903, -0.2191012, -0.2429802, -0.2667128, -0.2902847, -0.3136817, -0.3368899, -0.3598950,
    -0.3826834, -0.4052413, -0.4275551, -0.4496113, -0.4713967, -0.4928982, -0.5141027, -0.5349976,
    -0.5555702, -0.5758082, -0.5956993, -0.6152316, -0.6343933, -0.6531728, -0.6715590, -0.6895405,
    -0.7071068, -0.7242471, -0.7409511, -0.7572088, -0.7730105, -0.7883464, -0.8032075, -0.8175848,
    -0.8314696, -0.8448536, -0.8577286, -0.8700870, -0.8819213, -0.8932243, -0.9039893, -0.9142098,
    -0.9238795, -0.9329928, -0.9415441, -0.9495282, -0.9569403, -0.9637761, -0.9700313, -0.9757021,
    -0.9807853, -0.9852776, -0.9891765, -0.9924795, -0.9951847, -0.9972905, -0.9987955, -0.9996988,
    -1.0000000, -0.9996988, -0.9987955, -0.9972905, -0.9951847, -0.9924795, -0.9891765, -0.9852776,
    -0.9807853, -0.9757021, -0.9700313, -0.9637761, -0.9569403, -0.9495282, -0.9415441, -0.9329928,
    -0.9238795, -0.9142098, -0.9039893, -0.8932243, -0.8819213, -0.8700870, -0.8577286, -0.8448536,
    -0.8314696, -0.8175848, -0.8032075, -0.7883464, -0.7730105, -0.7572088, -0.7409511, -0.7242471,
    -0.7071068, -0.6895405, -0.6715590, -0.6531728, -0.6343933, -0.6152316, -0.5956993, -0.5758082,
    -0.5555702, -0.5349976, -0.5141027, -0.4928982, -0.4713967, -0.4496113, -0.4275551, -0.4052413,
    -0.3826834, -0.3598950, -0.3368899, -0.3136817, -0.2902847, -0.2667128, -0.2429802, -0.2191012,
    -0.1950903, -0.1709619, -0.1467305, -0.1224107, -0.0980171, -0.0735646, -0.0490677, -0.0245412
};

constexpr float VALID_COSINES[ANGLE_DISCRETIZATION] PROGMEM = {
    1.0000000, 0.9996988, 0.9987955, 0.9972905, 0.9951847, 0.9924795, 0.9891765, 0.9852776,
    0.9807853, 0.9757021, 0.9700313, 0.9637761, 0.9569403, 0.9495282, 0.9415441, 0.9329928,
    0.9238795, 0.9142098, 0.9039893, 0.8932243, 0.8819213, 0.8700870, 0.8577286, 0.8448536,
    0.8314696, 0.8175848, 0.8032075, 0.7883464, 0.7730105, 0.7572088, 0.7409511, 0.7242471,
    0.7071068, 0.6895405, 0.6715590, 0.6531728, 0.6343933, 0.6152316, 0.5956993, 0.5758082,
    0.5555702, 0.5349976, 0.5141027, 0.4928982, 0.4713967, 0.4496113, 0.4275551, 0.4052413,
    0.3826834, 0.3598950, 0.3368899, 0.3136817, 0.2902847, 0.2667128, 0.2429802, 0.2191012,
    0.1950903, 0.1709619, 0.1467305, 0.1224107, 0.0980171, 0.0735646, 0.0490677, 0.0245412,
    0.0000000, -0.0245412, -0.0490677, -0.0735646, -0.0980171, -0.1224107, -0.1467305, -0.1709619,
    -0.1950903, -0.2191012, -0.2429802, -0.2667128, -0.2902847, -0.3136817, -0.3368899, -0.3598950,
    -0.3826834, -0.4052413, -0.4275551, -0.4496113, -0.4713967, -0.4928982, -0.5141027, -0.5349976,
    -0.5555702, -0.5758082, -0.5956993, -0.6152316, -0.6343933, -0.6531728, -0.6715590, -0.6895405,
    -0.7071068, -0.7242471, -0.7409511, -0.7572088, -0.7730105, -0.7883464, -0.8032075, -0.8175848,
    -0.8314696, -0.8448536, -0.8577286, -0.8700870, -0.8819213, -0.8932243, -0.9039893, -0.9142098,
    -0.9238795, -0.9329928, -0.9415441, -0.9495282, -0.9569403, -0.9637761, -0.9700313, -0.9757021,
    -0.9807853, -0.9852776, -0.9891765, -0.9924795, -0.9951847, -0.9972905, -0.9987955, -0.9996988,
    -1.0000000, -0.9996988, -0.9987955, -0.9972905, -0.9951847, -0.9924795, -0.9891765, -0.9852776,
    -0.9807853, -0.9757021, -0.9700313, -0.9637761, -0.9569403, -0.9495282, -0.9415441, -0.9329928,
    -0.9238795, -0.9142098, -0.9039893, -0.8932243, -0.8819213, -0.8700870, -0.8577286, -0.8448536,
    -0.8314696, -0.8175848, -0.8032075, -0.7883464, -0.7730105, -0.7572088, -0.7409511, -0.7242471,
    -0.7071068, -0.6895405, -0.6715590, -0.6531728, -0.6343933, -0.6152316, -0.5956993, -0.5758082,
    -0.5555702, -0.5349976, -0.5141027, -0.4928982, -0.4713967, -0.4496113, -0.4275551, -0.4052413,
    -0.3826834, -0.3598950, -0.3368899, -0.3136817, -0.2902847, -0.2667128, -0.2429802, -0.2191012,
    -0.1950903, -0.1709619, -0.1467305, -0.1224107, -0.0980171, -0.0735646, -0.0490677, -0.0245412,
    -0.0000000, 0.0245412, 0.0490677, 0.0735646, 0.0980171, 0.1224107, 0.1467305, 0.1709619,
    0.1950903, 0.2191012, 0.2429802, 0.2667128, 0.2902847, 0.3136817, 0.3368899, 0.3598950,
    0.3826834, 0.4052413, 0.4275551, 0.4496113, 0.4713967, 0.4928982, 0.5141027, 0.5349976,
    0.5555702, 0.5758082, 0.5956993, 0.6152316, 0.6343933, 0.6531728, 0.6715590, 0.6895405,
    0.7071068, 0.7242471, 0.7409511, 0.7572088, 0.7730105, 0.7883464, 0.8032075, 0.8175848,
    0.8314696, 0.8448536, 0.8577286, 0.8700870, 0.8819213, 0.8932243, 0.9039893, 0.9142098,
    0.9238795, 0.9329928, 0.9415441, 0.9495282, 0.9569403, 0.9637761, 0.9700313, 0.9757021,
    0.9807853, 0.9852776, 0.9891765, 0.9924795, 0.9951847, 0.9972905, 0.9987955, 0.9996988
};

constexpr float VALID_ROTATIONAL_VELOCITIES[ROTATIONAL_VELOCITY_DISCRETIZATION] = {
    0, 0.05, 0.1, 0.15, 0.2, 0.25, 0.3, 0.35, 0.4, 0.45, 0.5, 0.55, 0.6, 0.65, 0.7, 0.75
};

constexpr float VALID_MAGNITUDES[MAGNITUDE_DISCRETIZATION] = {
    0, 0.0625, 0.125, 0.1875, 0.25, 0.3125, 0.375, 0.4375, 0.5, 0.5625, 0.625, 0.6875, 0.75, 0.8125, 0.875, 0.9375
};

// TODO: measure accurately
constexpr float R = 0.03;           // wheel radius
constexpr float L = 0.11;           // half length of front-back distance (between wheel centers)
constexpr const float W_t = 0.16;   // half length of left-right distance (between wheel inner edges)

constexpr float KI_11 =   1.0/R;               
constexpr float KI_12 =   KI_11;// 1/R;               
constexpr float KI_13 = -(1.0/R)*(W_t + L); 
constexpr float KI_21 =   1.0/R;
constexpr float KI_22 = -(1.0/R);
constexpr float KI_23 =  (1/R)*(W_t + L);
constexpr float KI_31 =   1/R;
constexpr float KI_32 = -(1/R);
constexpr float KI_33 = -(1/R)*(W_t + L);
constexpr float KI_41 =   1/R;
constexpr float KI_42 =   1/R;
constexpr float KI_43 =  (1/R)*(W_t + L);

#endif // __CAR_CONSTANTS_H__ 
